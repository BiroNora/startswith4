// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model School {
  school_id    Int               @id @default(autoincrement())
  om_id        String?
  name         String
  zip_code     String
  address      String
  dir_name     String?
  dir_phone    String?
  school_email String            @unique
  website      String?
  school_type  String[]
  coop         Boolean?
  note         String?
  city         City              @relation(fields: [city_id], references: [city_id])
  city_id      Int
  country      Country           @relation(fields: [country_id], references: [country_id])
  country_id   Int
  county       County            @relation(fields: [county_id], references: [county_id])
  county_id    Int
  event        Event[]
  region       Region            @relation(fields: [region_id], references: [region_id])
  region_id    Int
  contact      ContactOnSchool[]

  @@map("schools")
}

model ContactOnSchool {
  conSchoo_id   Int     @id @default(autoincrement())
  school        School  @relation(fields: [school_email], references: [school_email])
  school_email  String
  Contact       Contact @relation(fields: [contact_email], references: [contact_email])
  contact_email String

  @@map("contactonschool")
}

model Contact {
  contact_id    Int               @id @default(autoincrement())
  contact_email String            @unique
  contact_name  String?
  contact_phone String?
  contact_note  String?
  School        ContactOnSchool[]
  User          ContactOnUser[]

  @@map("contacts")
}

model ContactOnUser {
  conUser_id    Int     @id @default(autoincrement())
  User          User    @relation(fields: [user_email], references: [user_email])
  user_email    String
  Contact       Contact @relation(fields: [contact_email], references: [contact_email])
  contact_email String

  @@map("contactonuser")
}

model User {
  user_id       String          @id @default(uuid())
  name          String
  nationality   String
  phone         String
  user_email    String          @unique
  basic         Boolean?
  regionB       Int?
  medior        Boolean?
  regionM       Int?
  high          Boolean?
  regionH       Int?
  superior      Boolean?
  regionS       Int?
  director      Boolean?
  event         Event[]
  passwordHash  String
  userAuthToken String          @unique
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  Contact       ContactOnUser[]

  @@map("users")
}

model Event {
  event_id           Int                  @id @default(autoincrement())
  create_date        DateTime             @default(now())
  closing_date       DateTime
  event_type         EventType            @default(PRESENTATION)
  presented_student  Int?
  note               String?
  School             School               @relation(fields: [school_id], references: [school_id])
  school_id          Int
  User               User                 @relation(fields: [user_id], references: [user_id])
  user_id            String
  InterestedStudents InterestedStudents[]

  @@map("events")
}

model InterestedStudents {
  intrest_id Int       @id @default(autoincrement())
  event_id   Int
  count      Int
  city       String
  grade      Grade
  region     String
  notice     Notice
  applied    Boolean
  work_title String
  admission  Admission
  regionId   Int       @unique
  Event      Event     @relation(fields: [event_id], references: [event_id])

  @@map("interested")
}

model Activity {
  act_id          Int      @id @default(autoincrement())
  date            DateTime
  act_name        String
  act_description String

  @@map("activity")
}

model Country {
  country_id   Int      @id @default(autoincrement())
  country_name String   @unique
  Region       Region[]
  School       School[]

  @@map("country")
}

model Region {
  region_id   Int      @id @default(autoincrement())
  region_name String   @unique
  country     Country  @relation(fields: [country_id], references: [country_id])
  country_id  Int
  County      County[]
  School      School[]

  @@map("region")
}

model County {
  county_id   Int      @id @default(autoincrement())
  county_name String   @unique
  region      Region   @relation(fields: [region_id], references: [region_id])
  region_id   Int
  city        City[]
  School      School[]

  @@map("county")
}

model City {
  city_id   Int      @id @default(autoincrement())
  city_name String   @unique
  county    County   @relation(fields: [county_id], references: [county_id])
  county_id Int
  School    School[]

  @@map("city")
}

enum Duty {
  SUPERIOR
  BASIC
  MEDIOR
  HIGH
}

enum EventType {
  PRESENTATION
  OPEN_DAY
  BY_PHONE
  BY_EMAIL
  TV
  RADIO
  ONLINE
  MEDIOR_LEAFLET
}

enum Grade {
  PREPARATORY
  CLASS_9
  CLASS_10
  CLASS_11
  CLASS_12
}

enum Notice {
  SCHOOL_PRESENTATION
  FAMILY
  TEACHER
  FRENDS
  CMM_MEMBER
  CHLC
  HIGH
  FACEBOOK
  ONLINE_PUBLICITY
}

enum Admission {
  ADMITTED
  REJECTED
  IN_PROGRESS
}
